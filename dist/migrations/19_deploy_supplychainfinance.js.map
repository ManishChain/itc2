{"version":3,"file":"19_deploy_supplychainfinance.js","sourceRoot":"","sources":["../../migrations/19_deploy_supplychainfinance.ts"],"names":[],"mappings":";;AAAA,+EAAiG;AAWjG,MAAM,UAAU,GAAuB,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;AACvE,MAAM,0BAA0B,GAAuC,SAAS,CAAC,OAAO,CAAC,4BAA4B,CAAC,CAAC;AACvH,MAAM,yBAAyB,GAAsC,SAAS,CAAC,OAAO,CAAC,2BAA2B,CAAC,CAAC;AACpH,MAAM,iBAAiB,GAA8B,SAAS,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC;AAC5F,MAAM,iBAAiB,GAA8B,SAAS,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC;AAE5F,8DAA8D;AAC9D,MAAM,EAAE,eAAe,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC,6DAA6D;AAE5I,MAAM,CAAC,OAAO,GAAG,KAAK,EAAE,QAA0B,EAAE,OAAe,EAAE,QAAkB,EAAE,EAAE;IACzF,IAAI,eAAe,EAAE,CAAC,QAAQ,CAAC,eAAe,CAAC,EAAE;QAC/C,8DAA8D;QAC9D,MAAM,aAAa,GAAG,OAAO,CAAC,gDAAgD,CAAC,CAAC;QAEhF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,iDAAwB,CAChD,QAAQ,EACR,QAAQ,EACR,UAAU,EACV,0BAA0B,EAC1B,yBAAyB,EACzB,CAAC,iBAAiB,EAAE,iBAAiB,CAAC,EACtC,aAAa,EACb,aAAa,CACd,CAAC;QAEF,MAAM,mBAAmB,GAAG;YAC1B;gBACE,YAAY,EAAE,mBAAmB;gBAEjC,SAAS,EAAE,KAAK;gBAChB,QAAQ,EAAE,QAAQ;gBAClB,UAAU,EAAE,UAAU;gBACtB,KAAK,EAAE,OAAO;gBACd,iBAAiB,EAAE,UAAU;gBAC7B,gBAAgB,EAAE,wBAAwB;aAC3C;YACD;gBACE,YAAY,EAAE,mBAAmB;gBAEjC,SAAS,EAAE,KAAK;gBAChB,QAAQ,EAAE,QAAQ;gBAClB,UAAU,EAAE,UAAU;gBACtB,KAAK,EAAE,OAAO;gBACd,iBAAiB,EAAE,UAAU;gBAC7B,gBAAgB,EAAE,uBAAuB;aAC1C;SACF,CAAC;QAEF,KAAK,MAAM,kBAAkB,IAAI,mBAAmB,EAAE;YACpD,MAAM,wBAAwB,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAC;SAC7D;KACF;AACH,CAAC,CAAC;AAEF,KAAK,UAAU,wBAAwB,CACrC,OAA0C,EAC1C,kBASC;IAED,MAAM,QAAQ,GAAG,MAAM,0CAAiB,CAAC;QACvC,SAAS,EAAE,kBAAkB,CAAC,SAAS;QACvC,QAAQ,EAAE,kBAAkB,CAAC,QAAQ;QACrC,UAAU,EAAE,kBAAkB,CAAC,UAAU;QACzC,KAAK,EAAE,kBAAkB,CAAC,KAAK;QAC/B,iBAAiB,EAAE,kBAAkB,CAAC,iBAAiB;QACvD,gBAAgB,EAAE,kBAAkB,CAAC,gBAAgB;KACtD,CAAC,CAAC;IACH,MAAM,OAAO,CAAC,MAAM,CAAC,kBAAkB,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;AAClE,CAAC","sourcesContent":["import { deployStateMachineSystem, storeIpfsJsonData } from '@settlemint/enteth-migration-utils';\n\nimport { AdminRoleRegistryContract } from '../types/truffle-contracts/AdminRoleRegistry';\nimport { BuyerRoleRegistryContract } from '../types/truffle-contracts/BuyerRoleRegistry';\nimport { GateKeeperContract } from '../types/truffle-contracts/GateKeeper';\nimport {\n  SupplyChainFinanceFactoryContract,\n  SupplyChainFinanceFactoryInstance,\n} from '../types/truffle-contracts/SupplyChainFinanceFactory';\nimport { SupplyChainFinanceRegistryContract } from '../types/truffle-contracts/SupplyChainFinanceRegistry';\n\nconst GateKeeper: GateKeeperContract = artifacts.require('GateKeeper');\nconst SupplyChainFinanceRegistry: SupplyChainFinanceRegistryContract = artifacts.require('SupplyChainFinanceRegistry');\nconst SupplyChainFinanceFactory: SupplyChainFinanceFactoryContract = artifacts.require('SupplyChainFinanceFactory');\nconst AdminRoleRegistry: AdminRoleRegistryContract = artifacts.require('AdminRoleRegistry');\nconst BuyerRoleRegistry: BuyerRoleRegistryContract = artifacts.require('BuyerRoleRegistry');\n\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst { enabledFeatures, storeIpfsHash } = require('../../truffle-config.js'); // two dirs up, because it is compiled into ./dist/migrations\n\nmodule.exports = async (deployer: Truffle.Deployer, network: string, accounts: string[]) => {\n  if (enabledFeatures().includes('SUPPLYFINANCE')) {\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const uiDefinitions = require('../../contracts/supplychain/UIDefinitions.json');\n\n    const { factory } = await deployStateMachineSystem(\n      deployer,\n      accounts,\n      GateKeeper,\n      SupplyChainFinanceRegistry,\n      SupplyChainFinanceFactory,\n      [AdminRoleRegistry, BuyerRoleRegistry],\n      uiDefinitions,\n      storeIpfsHash\n    );\n\n    const SupplyChainFinances = [\n      {\n        Order_Number: '5YJXCAE45GFF00001',\n\n        Item_Name: 'Car',\n        Quantity: '425382',\n        Order_date: 1558362520,\n        Price: '55000',\n        Delivery_Duration: '6 Months',\n        Delivery_Address: 'Street 4, City Central',\n      },\n      {\n        Order_Number: '5YJRE1A31A1P01234',\n\n        Item_Name: 'Car',\n        Quantity: '123054',\n        Order_date: 1558062520,\n        Price: '55000',\n        Delivery_Duration: '8 Months',\n        Delivery_Address: 'Street 5, City Square',\n      },\n    ];\n\n    for (const SupplyChainFinance of SupplyChainFinances) {\n      await createSupplyChainFinance(factory, SupplyChainFinance);\n    }\n  }\n};\n\nasync function createSupplyChainFinance(\n  factory: SupplyChainFinanceFactoryInstance,\n  SupplyChainFinance: {\n    Order_Number: string;\n\n    Item_Name: string;\n    Quantity: string;\n    Order_date: number;\n    Price: string;\n    Delivery_Duration: string;\n    Delivery_Address: string;\n  }\n) {\n  const ipfsHash = await storeIpfsJsonData({\n    Item_Name: SupplyChainFinance.Item_Name,\n    Quantity: SupplyChainFinance.Quantity,\n    Order_date: SupplyChainFinance.Order_date,\n    Price: SupplyChainFinance.Price,\n    Delivery_Duration: SupplyChainFinance.Delivery_Duration,\n    Delivery_Address: SupplyChainFinance.Delivery_Address,\n  });\n  await factory.create(SupplyChainFinance.Order_Number, ipfsHash);\n}\n"]}