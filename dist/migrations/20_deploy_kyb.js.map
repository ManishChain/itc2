{"version":3,"file":"20_deploy_kyb.js","sourceRoot":"","sources":["../../migrations/20_deploy_kyb.ts"],"names":[],"mappings":";;AAAA,+EAAiG;AAWjG,MAAM,UAAU,GAAuB,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;AACvE,MAAM,wBAAwB,GAAqC,SAAS,CAAC,OAAO,CAAC,0BAA0B,CAAC,CAAC;AACjH,MAAM,uBAAuB,GAAoC,SAAS,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC;AAC9G,MAAM,iBAAiB,GAA8B,SAAS,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC;AAC5F,MAAM,qBAAqB,GAAkC,SAAS,CAAC,OAAO,CAAC,uBAAuB,CAAC,CAAC;AAExG,8DAA8D;AAC9D,MAAM,EAAE,eAAe,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC,6DAA6D;AAE5I,MAAM,CAAC,OAAO,GAAG,KAAK,EAAE,QAA0B,EAAE,OAAe,EAAE,QAAkB,EAAE,EAAE;IACzF,IAAI,eAAe,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;QACrC,8DAA8D;QAC9D,MAAM,aAAa,GAAG,OAAO,CAAC,qDAAqD,CAAC,CAAC;QAErF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,iDAAwB,CAChD,QAAQ,EACR,QAAQ,EACR,UAAU,EACV,wBAAwB,EACxB,uBAAuB,EACvB,CAAC,iBAAiB,EAAE,qBAAqB,CAAC,EAC1C,aAAa,EACb,aAAa,CACd,CAAC;QAEF,MAAM,iBAAiB,GAAG;YACxB;gBACE,IAAI,EAAE,eAAe;gBACrB,OAAO,EAAE,UAAU;gBACnB,QAAQ,EAAE,kBAAkB;gBAC5B,qBAAqB,EAAE,MAAM;gBAC7B,mBAAmB,EAAE,QAAQ;gBAC7B,eAAe,EAAE,cAAc;aAChC;SACF,CAAC;QACF,KAAK,MAAM,gBAAgB,IAAI,iBAAiB,EAAE;YAChD,MAAM,sBAAsB,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAAC;SACzD;KACF;AACH,CAAC,CAAC;AAEF,KAAK,UAAU,sBAAsB,CACnC,OAAwC,EACxC,gBAQC;IAED,MAAM,QAAQ,GAAG,MAAM,0CAAiB,CAAC;QACvC,OAAO,EAAE,gBAAgB,CAAC,OAAO;QACjC,QAAQ,EAAE,gBAAgB,CAAC,QAAQ;QACnC,qBAAqB,EAAE,gBAAgB,CAAC,qBAAqB;QAC7D,mBAAmB,EAAE,gBAAgB,CAAC,mBAAmB;QACzD,eAAe,EAAE,gBAAgB,CAAC,eAAe;KAClD,CAAC,CAAC;IACH,MAAM,OAAO,CAAC,MAAM,CAAC,gBAAgB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AACxD,CAAC","sourcesContent":["import { deployStateMachineSystem, storeIpfsJsonData } from '@settlemint/enteth-migration-utils';\n\nimport { AdminRoleRegistryContract } from '../types/truffle-contracts/AdminRoleRegistry';\nimport { GateKeeperContract } from '../types/truffle-contracts/GateKeeper';\nimport {\n  KnowYourBusinessFactoryContract,\n  KnowYourBusinessFactoryInstance,\n} from '../types/truffle-contracts/KnowYourBusinessFactory';\nimport { KnowYourBusinessRegistryContract } from '../types/truffle-contracts/KnowYourBusinessRegistry';\nimport { RequesterRoleRegistryContract } from '../types/truffle-contracts/RequesterRoleRegistry';\n\nconst GateKeeper: GateKeeperContract = artifacts.require('GateKeeper');\nconst KnowYourBusinessRegistry: KnowYourBusinessRegistryContract = artifacts.require('KnowYourBusinessRegistry');\nconst KnowYourBusinessFactory: KnowYourBusinessFactoryContract = artifacts.require('KnowYourBusinessFactory');\nconst AdminRoleRegistry: AdminRoleRegistryContract = artifacts.require('AdminRoleRegistry');\nconst RequesterRoleRegistry: RequesterRoleRegistryContract = artifacts.require('RequesterRoleRegistry');\n\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst { enabledFeatures, storeIpfsHash } = require('../../truffle-config.js'); // two dirs up, because it is compiled into ./dist/migrations\n\nmodule.exports = async (deployer: Truffle.Deployer, network: string, accounts: string[]) => {\n  if (enabledFeatures().includes('KYB')) {\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const uiDefinitions = require('../../contracts/knowyourbusiness/UIDefinitions.json');\n\n    const { factory } = await deployStateMachineSystem(\n      deployer,\n      accounts,\n      GateKeeper,\n      KnowYourBusinessRegistry,\n      KnowYourBusinessFactory,\n      [AdminRoleRegistry, RequesterRoleRegistry],\n      uiDefinitions,\n      storeIpfsHash\n    );\n\n    const KnowYourBusinesss = [\n      {\n        Name: 'Good_Business',\n        Address: 'Street-1',\n        Products: 'Premium_Products',\n        Year_of_Incorporation: '1995',\n        Registration_Number: '554848',\n        Contact_Details: 'abc@mail.com',\n      },\n    ];\n    for (const KnowYourBusiness of KnowYourBusinesss) {\n      await createKnowYourBusiness(factory, KnowYourBusiness);\n    }\n  }\n};\n\nasync function createKnowYourBusiness(\n  factory: KnowYourBusinessFactoryInstance,\n  KnowYourBusiness: {\n    Name: string;\n\n    Address: string;\n    Products: string;\n    Year_of_Incorporation: string;\n    Registration_Number: string;\n    Contact_Details: string;\n  }\n) {\n  const ipfsHash = await storeIpfsJsonData({\n    Address: KnowYourBusiness.Address,\n    Products: KnowYourBusiness.Products,\n    Year_of_Incorporation: KnowYourBusiness.Year_of_Incorporation,\n    Registration_Number: KnowYourBusiness.Registration_Number,\n    Contact_Details: KnowYourBusiness.Contact_Details,\n  });\n  await factory.create(KnowYourBusiness.Name, ipfsHash);\n}\n"]}